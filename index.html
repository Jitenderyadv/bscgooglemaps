<!DOCTYPE html>
<html lang="en">

<head>
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>

<body>

    <div class="container">
        <form class="form-horizontal">
            <fieldset>

                <!-- Form Name -->
                <legend>Configure Map Parameters</legend>

                <!-- Text input-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="apiKey">API Key</label>
                    <div class="col-md-4">
                        <input id="apiKey" name="apiKey" type="text" placeholder="API Key (optional)" class="form-control input-md">

                    </div>
                </div>

                <!-- Text input-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="mapCentre">Map Centre</label>
                    <div class="col-md-4">
                        <input id="mapCentre" name="mapCentre" type="text" placeholder="Map Centre" class="form-control input-md" required="">

                    </div>
                </div>

                <!-- Text input-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="mapWidth">Width</label>
                    <div class="col-md-2">
                        <input id="mapWidth" name="mapWidth" type="text" placeholder="Width" class="form-control input-md" required="">

                    </div>
                </div>

                <!-- Text input-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="mapHeight">Height</label>
                    <div class="col-md-2">
                        <input id="mapHeight" name="mapHeight" type="text" placeholder="Height" class="form-control input-md" required="">

                    </div>
                </div>
    </div>


    </fieldset>
    </form>

    </div>

    <script src="/blocksdk.js"></script>

    <script>
        let sdk = new window.sfdc.BlockSDK(); //initalize SDK

        let dataObject = {
            apiKey: document.getElementById('apiKey').value,
            mapCentre: document.getElementById('mapCentre').value,
            mapHeight: document.getElementById('mapHeight').value,
            mapWidth: document.getElementById('mapWidth').value
        };

        let defualtContent = '<img width="600" src="https://maps.googleapis.com/maps/api/staticmap?center=London,+UK&zoom=12&scale=1&size=600x300&maptype=roadmap&format=png&visual_refresh=true" alt="Google Map of Albany, NY">';

        // console.log('apiKey' + apiKey);
        // console.log('mapWidth' + mapWidth);
        // console.log('mapHeight' + mapHeight);
        // console.log('mapCentre' + mapCentre);
        // let dataObject = {};
        sdk.getData((data) => {
            if (Object.keys(data).length == 0) {
                data = dataObject;
            } else {
                document.getElementById('apiKey').value = data.apiKey;
                document.getElementById('mapWidth').value = data.mapWidth;
                document.getElementById('mapHeight').value = data.mapHeight;
                document.getElementById('mapCentre').value = data.mapCentre;
            }
        })


        // sdk.setSuperContent(defualtContent, (newSuperContent) => {
        //     defualtContent = newSuperContent;
        // });



        // <!-- 
        //         sdk.getContent((content) => {
        //             content += '.';
        //             console.log('-- Content: ' + content);

        //             sdk.setContent(content, (setContent) => {
        //                 // block content is now its original content + '.'
        //             });
        //         }); -->

        sdk.setContent('<h1>' + JSON.stringify(dataObject) + '</h1>');
    </script>

</body>

</html>